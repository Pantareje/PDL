\appendix
\section{Anexo - Analizador Léxico}

\lstset{
  language=C,
  basicstyle=\ttfamily\scriptsize,
  keywordstyle=,
  showstringspaces=false,
  escapeinside={(*@}{@*)},
}

\begin{enumerate}

    \item \textbf{Caso 1:} Funcionamiento correcto
    \begin{tcolorbox}[title={Código fuente}, colback=white]
        \begin{lstlisting}
/* Declaraciones válidas */
var boolean a;
var int b;
var string d;

/* Se vuelve a declarar la variable «a», pero no es error léxico. */
var int a;

/* El tipo «bool» no existe, se trata como identificador. */
var bool err;
        \end{lstlisting}
    \end{tcolorbox}

    \begin{tcolorbox}[title={Volcado del fichero de tokens}, colback=white]
        \begin{lstlisting}
<var, >
<bool, >
<id, 0>
<scol, >
<var, >
<int, >
<id, 1>
<scol, >
<var, >
<str, >
<id, 2>
<scol, >
<var, >
<int, >
<id, 0>
<scol, >
<var, >
<id, 3>
<id, 4>
<scol, >
<eof, >
        \end{lstlisting}
    \end{tcolorbox}

    \begin{tcolorbox}[title={Volcado del fichero de la tabla de símbolos}, colback=white]
        \begin{lstlisting}
Tabla Global #0:
*'a'
*'b'
*'d'
*'bool'
*'err'
        \end{lstlisting}
    \end{tcolorbox}


    \item \textbf{Caso 2:} Funcionamiento correcto
    \begin{tcolorbox}[title={Código fuente}, colback=white]
        \begin{lstlisting}
function void println(string s) {
    output s;
    output '\n';
}

println('¡Hola mundo!');
println('Eso son llamadas a \'output\' usando una función.');
        \end{lstlisting}
    \end{tcolorbox}

    \begin{tcolorbox}[title={Volcado del fichero de tokens}, colback=white]
        \begin{lstlisting}
<fn, >
<void, >
<id, 0>
<po, >
<str, >
<id, 1>
<pc, >
<cbo, >
<out, >
<id, 1>
<scol, >
<out, >
<cstr, "\n">
<scol, >
<cbc, >
<id, 0>
<po, >
<cstr, "¡Hola mundo!">
<pc, >
<scol, >
<id, 0>
<po, >
<cstr, "Eso son llamadas a \'output\' usando una función.">
<pc, >
<scol, >
<eof, >
        \end{lstlisting}
    \end{tcolorbox}

    \begin{tcolorbox}[title={Volcado del fichero de la tabla de símbolos}, colback=white]
        \begin{lstlisting}
Tabla Global #0:
*'println'
*'s'
        \end{lstlisting}
    \end{tcolorbox}


    \item \textbf{Caso 3:} Funcionamiento correcto
    \begin{tcolorbox}[title={Código fuente}, colback=white]
        \begin{lstlisting}
/* Leemos dos números del usuario. Las variables sin declarar se suponen globales y enteras. */
input a;
input b;

/* Comparamos los números entre sí. */
if (a < b) {
    output '\'a\' es menor que \'b\'.';
}
if (a > b) {
    output '\'a\' es mayor que \'b\'.';
}

output '\n';

/* Operamos con los números. */

output 'a + b: ';
output a + b;

output 'a - b: ';
output a - b;

output '\n';
        \end{lstlisting}        
    \end{tcolorbox}

    \begin{tcolorbox}[title={Volcado del fichero de tokens}, colback=white]
        \begin{lstlisting}
<in, >
<id, 0>
<scol, >
<in, >
<id, 1>
<scol, >
<if, >
<po, >
<id, 0>
<ls, >
<id, 1>
<pc, >
<cbo, >
<out, >
<cstr, "\'a\' es menor que \'b\'.">
<scol, >
<cbc, >
<if, >
<po, >
<id, 0>
<gr, >
<id, 1>
<pc, >
<cbo, >
<out, >
<cstr, "\'a\' es mayor que \'b\'.">
<scol, >
<cbc, >
<out, >
<cstr, "\n">
<scol, >
<out, >
<cstr, "a + b: ">
<scol, >
<out, >
<id, 0>
<sum, >
<id, 1>
<scol, >
<out, >
<cstr, "a - b: ">
<scol, >
<out, >
<id, 0>
<sub, >
<id, 1>
<scol, >
<out, >
<cstr, "\n">
<scol, >
<eof, >
        \end{lstlisting}
    \end{tcolorbox}

    \begin{tcolorbox}[title={Volcado del fichero de la tabla de símbolos}, colback=white]
        \begin{lstlisting}
Tabla Global #0:
*'a'
*'b'
        \end{lstlisting}
    \end{tcolorbox}

    
    \item \textbf{Caso 4:} Funcionamiento erróneo
    \begin{tcolorbox}[title={Código fuente}, colback=white]
        \begin{lstlisting}
/* Un comentario de bloque sin cerrar es un error léxico, ya que se recibe un EOF inesperado.
        \end{lstlisting}      
    \end{tcolorbox}

    \begin{tcolorbox}[title={Errores detectados}, colback=white]
        \begin{lstlisting}
(2:1) ERROR: Fin de fichero inesperado. Se esperaba «*/» para cerrar el comentario de bloque.
        \end{lstlisting}
    \end{tcolorbox}


    \item \textbf{Caso 5:} Funcionamiento erróneo
    \begin{tcolorbox}[title={Código fuente}, colback=white]
        \begin{lstlisting}
/* Hay algunos símbolos por los que un token no puede empezar. */
$ % @ # ?

/* En especial, las variables no pueden empezar con «_». */
var int _error;
        \end{lstlisting}      
    \end{tcolorbox}

    \begin{tcolorbox}[title={Errores detectados}, colback=white]
        \begin{lstlisting}
(2:1) ERROR: Carácter inesperado al buscar el siguiente símbolo («$», U+0024).
(2:3) ERROR: Carácter inesperado al buscar el siguiente símbolo («%», U+0025).
(2:5) ERROR: Carácter inesperado al buscar el siguiente símbolo («@», U+0040).
(2:7) ERROR: Carácter inesperado al buscar el siguiente símbolo («#», U+0023).
(2:9) ERROR: Carácter inesperado al buscar el siguiente símbolo («?», U+003F).
(5:9) ERROR: Carácter inesperado al buscar el siguiente símbolo («_», U+005F).
        \end{lstlisting}
    \end{tcolorbox}

    
    \item \textbf{Caso 6:} Funcionamiento erróneo
    \begin{tcolorbox}[title={Código fuente}, colback=white]
        \begin{lstlisting}
/* Aunque el código esté malformado y no compile, se siguen buscando y generando tokens */
var string a = $ 'Esta cadena se lee correctamente';

/* Esto es útil para depurar los errores sin detenerse sólo en el primero. */
var int a = 2?;

/* En algunos casos, es imposible recuperar tokens en un estado válido y seguir procesando. */
var string s = 'Si no se temina el string, lee todo \'; $$ /**/;; Esto es parte de la cadena.
/* Aquí ya ha terminado la cadena, ya que lee un salto de línea no permitido. */

/* Como la última cadena ya finalizó por error, aquí se recupera y sigue procesando tokens. */
var string s2 = 'Esta cadena se procesa bien';
        \end{lstlisting}      
    \end{tcolorbox}

    \begin{tcolorbox}[title={Errores detectados}, colback=white]
        \begin{lstlisting}
(2:16) ERROR: Carácter inesperado al buscar el siguiente símbolo («$», U+0024).
(5:14) ERROR: Carácter inesperado al buscar el siguiente símbolo («?», U+003F).
(8:94) ERROR: Error en la cadena. Carácter no permitido (U+000D).
        \end{lstlisting}
    \end{tcolorbox}

\end{enumerate}

\newpage

\section{Anexo - Pseudocódigo}
\input{AnexoPseudocode.tex}

\newpage

\section{Anexo - Analizador Sintáctico}

\begin{enumerate}

    \item \textbf{Caso 1:} Funcionamiento correcto
    \begin{tcolorbox}[title={Código fuente}, colback=white, breakable]
        \begin{lstlisting}
/* Programa con con sólo declaraciones de nivel superior. */
var boolean a;
var int b;
var string c;

/* Declarar de nuevo una variable es error semántico, no sintáctico. */
var int a;
        \end{lstlisting}
    \end{tcolorbox}

    \begin{tcolorbox}[title={Volcado del fichero de parse}, colback=white]
Des 2 18 8 2 18 7 2 18 9 2 18 7 3
    \end{tcolorbox}

    \begin{tcolorbox}[title={Árbol sintáctico generado con la herramienta VASt}, colback=white]
        \begin{lstlisting}
· P (2)
  · STATEMENT (18)
    · var
    · VARTYPE (8)
      · boolean
    · id
    · ;
  · P (2)
    · STATEMENT (18)
      · var
      · VARTYPE (7)
        · int
      · id
      · ;
    · P (2)
      · STATEMENT (18)
        · var
        · VARTYPE (9)
          · string
        · id
        · ;
      · P (2)
        · STATEMENT (18)
          · var
          · VARTYPE (7)
            · int
          · id
          · ;
        · P (3)
          · eof
        \end{lstlisting}
    \end{tcolorbox}


    \item \textbf{Caso 2:} Funcionamiento correcto
    \begin{tcolorbox}[title={Código fuente}, colback=white, breakable]
        \begin{lstlisting}
/* En este programa, definimos y llamamos a funciones. */

function void println(string s) {
    output s;
    output '\n';
}

println('¡Hola mundo!');
println('Eso son llamadas a \'output\' usando una función.');
        \end{lstlisting}
    \end{tcolorbox}

    \begin{tcolorbox}[title={Volcado del fichero de parse}, colback=white]
Des 1 4 5 11 9 13 14 19 21 36 41 46 51 58 48 43 38 14 19 21 36 41 46 54 48 43 38 15 2 19 20 25 30 36 41 46 54 48 43 38 33 2 19 20 25 30 36 41 46 54 48 43 38 33 3
    \end{tcolorbox}

    \begin{tcolorbox}[title={Árbol sintáctico generado con la herramienta VASt}, colback=white, breakable]
        \begin{lstlisting}
· P (1)
  · FUNCTION (4)
    · function
    · FUNTYPE (5)
      · void
    · id
    · (
    · FUNATTRIBUTES (11)
      · VARTYPE (9)
        · string
      · id
      · NEXTATTRIBUTE (13)
        · lambda
    · )
    · {
    · BODY (14)
      · STATEMENT (19)
        · ATOMSTATEMENT (21)
          · output
          · EXP (36)
            · A (41)
              · B (46)
                · EXPATOM (51)
                  · id
                  · C (58)
                    · lambda
                · B1 (48)
                  · lambda
              · A1 (43)
                · lambda
            · EXP1 (38)
              · lambda
          · ;
      · BODY (14)
        · STATEMENT (19)
          · ATOMSTATEMENT (21)
            · output
            · EXP (36)
              · A (41)
                · B (46)
                  · EXPATOM (54)
                    · cstr
                  · B1 (48)
                    · lambda
                · A1 (43)
                  · lambda
              · EXP1 (38)
                · lambda
            · ;
        · BODY (15)
          · lambda
    · }
  · P (2)
    · STATEMENT (19)
      · ATOMSTATEMENT (20)
        · id
        · IDACT (25)
          · (
          · CALLPARAM (30)
            · EXP (36)
              · A (41)
                · B (46)
                  · EXPATOM (54)
                    · cstr
                  · B1 (48)
                    · lambda
                · A1 (43)
                  · lambda
              · EXP1 (38)
                · lambda
            · NEXTPARAM (33)
              · lambda
          · )
        · ;
    · P (2)
      · STATEMENT (19)
        · ATOMSTATEMENT (20)
          · id
          · IDACT (25)
            · (
            · CALLPARAM (30)
              · EXP (36)
                · A (41)
                  · B (46)
                    · EXPATOM (54)
                      · cstr
                    · B1 (48)
                      · lambda
                  · A1 (43)
                    · lambda
                · EXP1 (38)
                  · lambda
              · NEXTPARAM (33)
                · lambda
            · )
          · ;
      · P (3)
        · eof
        \end{lstlisting}
    \end{tcolorbox}


    \item \textbf{Caso 3:} Funcionamiento correcto
    \begin{tcolorbox}[title={Código fuente}, colback=white, breakable]
        \begin{lstlisting}
/* Leemos dos números del usuario. Las variables sin declarar se suponen globales y enteras. */
input a;
input b;

/* Comparamos los números entre sí. */
if (a < b)
    output '\'a\' es menor que \'b\'.';
if (a > b)
    output '\'a\' es mayor que \'b\'.';

output '\n';

/* Operamos con los números. */

output 'a + b: ';
output a + b;

output 'a - b: ';
output a - b;

output '\n';
        \end{lstlisting}        
    \end{tcolorbox}

    \begin{tcolorbox}[title={Volcado del fichero de parse}, colback=white, breakable]
Des 2 19 22 2 19 22 2 16 36 41 46 51 58 48 42 45 46 51 58 48 43 38 21 36 41 46 54 48 43 38 2 16 36 41 46 51 58 48 42 44 46 51 58 48 43 38 21 36 41 46 54 48 43 38 2 19 21 36 41 46 54 48 43 38 2 19 21 36 41 46 54 48 43 38 2 19 21 36 41 46 51 58 47 49 51 58 48 43 38 2 19 21 36 41 46 54 48 43 38 2 19 21 36 41 46 51 58 47 50 51 58 48 43 38 2 19 21 36 41 46 54 48 43 38 3
    \end{tcolorbox}

    \begin{tcolorbox}[title={Árbol sintáctico generado con la herramienta VASt}, colback=white, breakable]
        \begin{lstlisting}
· P (2)
  · STATEMENT (19)
    · ATOMSTATEMENT (22)
      · input
      · id
      · ;
  · P (2)
    · STATEMENT (19)
      · ATOMSTATEMENT (22)
        · input
        · id
        · ;
    · P (2)
      · STATEMENT (16)
        · if
        · (
        · EXP (36)
          · A (41)
            · B (46)
              · EXPATOM (51)
                · id
                · C (58)
                  · lambda
              · B1 (48)
                · lambda
            · A1 (42)
              · COMPOP (45)
                ·
              · B (46)
                · EXPATOM (51)
                  · id
                  · C (58)
                    · lambda
                · B1 (48)
                  · lambda
              · A1 (43)
                · lambda
          · EXP1 (38)
            · lambda
        · )
        · ATOMSTATEMENT (21)
          · output
          · EXP (36)
            · A (41)
              · B (46)
                · EXPATOM (54)
                  · cstr
                · B1 (48)
                  · lambda
              · A1 (43)
                · lambda
            · EXP1 (38)
              · lambda
          · ;
      · P (2)
        · STATEMENT (16)
          · if
          · (
          · EXP (36)
            · A (41)
              · B (46)
                · EXPATOM (51)
                  · id
                  · C (58)
                    · lambda
                · B1 (48)
                  · lambda
              · A1 (42)
                · COMPOP (44)
                  ·
                · B (46)
                  · EXPATOM (51)
                    · id
                    · C (58)
                      · lambda
                  · B1 (48)
                    · lambda
                · A1 (43)
                  · lambda
            · EXP1 (38)
              · lambda
          · )
          · ATOMSTATEMENT (21)
            · output
            · EXP (36)
              · A (41)
                · B (46)
                  · EXPATOM (54)
                    · cstr
                  · B1 (48)
                    · lambda
                · A1 (43)
                  · lambda
              · EXP1 (38)
                · lambda
            · ;
        · P (2)
          · STATEMENT (19)
            · ATOMSTATEMENT (21)
              · output
              · EXP (36)
                · A (41)
                  · B (46)
                    · EXPATOM (54)
                      · cstr
                    · B1 (48)
                      · lambda
                  · A1 (43)
                    · lambda
                · EXP1 (38)
                  · lambda
              · ;
          · P (2)
            · STATEMENT (19)
              · ATOMSTATEMENT (21)
                · output
                · EXP (36)
                  · A (41)
                    · B (46)
                      · EXPATOM (54)
                        · cstr
                      · B1 (48)
                        · lambda
                    · A1 (43)
                      · lambda
                  · EXP1 (38)
                    · lambda
                · ;
            · P (2)
              · STATEMENT (19)
                · ATOMSTATEMENT (21)
                  · output
                  · EXP (36)
                    · A (41)
                      · B (46)
                        · EXPATOM (51)
                          · id
                          · C (58)
                            · lambda
                        · B1 (47)
                          · ARITHMETICOP (49)
                            · +
                          · EXPATOM (51)
                            · id
                            · C (58)
                              · lambda
                          · B1 (48)
                            · lambda
                      · A1 (43)
                        · lambda
                    · EXP1 (38)
                      · lambda
                  · ;
              · P (2)
                · STATEMENT (19)
                  · ATOMSTATEMENT (21)
                    · output
                    · EXP (36)
                      · A (41)
                        · B (46)
                          · EXPATOM (54)
                            · cstr
                          · B1 (48)
                            · lambda
                        · A1 (43)
                          · lambda
                      · EXP1 (38)
                        · lambda
                    · ;
                · P (2)
                  · STATEMENT (19)
                    · ATOMSTATEMENT (21)
                      · output
                      · EXP (36)
                        · A (41)
                          · B (46)
                            · EXPATOM (51)
                              · id
                              · C (58)
                                · lambda
                            · B1 (47)
                              · ARITHMETICOP (50)
                                · -
                              · EXPATOM (51)
                                · id
                                · C (58)
                                  · lambda
                              · B1 (48)
                                · lambda
                          · A1 (43)
                            · lambda
                        · EXP1 (38)
                          · lambda
                      · ;
                  · P (2)
                    · STATEMENT (19)
                      · ATOMSTATEMENT (21)
                        · output
                        · EXP (36)
                          · A (41)
                            · B (46)
                              · EXPATOM (54)
                                · cstr
                              · B1 (48)
                                · lambda
                            · A1 (43)
                              · lambda
                          · EXP1 (38)
                            · lambda
                        · ;
                    · P (3)
                      · eof
        \end{lstlisting}
    \end{tcolorbox}

    
    \item \textbf{Caso 4:} Funcionamiento erróneo
    \begin{tcolorbox}[title={Código fuente}, colback=white, breakable]
        \begin{lstlisting}
/* No podemos declarar una variable con un tipo inexistente. */
var no_type err;
        \end{lstlisting}      
    \end{tcolorbox}

    \begin{tcolorbox}[title={Errores detectados}, colback=white]
        \begin{lstlisting}
(2:12) ERROR: Tipo de variable desconocido.
        \end{lstlisting}
    \end{tcolorbox}


    \item \textbf{Caso 5:} Funcionamiento erróneo
    \begin{tcolorbox}[title={Código fuente}, colback=white, breakable]
        \begin{lstlisting}
/* Una función puede usa «void» si no devuelve nada o si no toma argumentos. */
function void empty(void) {}

/* Una variable no puede ser de tipo «void». */
var void err;
        \end{lstlisting}      
    \end{tcolorbox}

    \begin{tcolorbox}[title={Errores detectados}, colback=white]
        \begin{lstlisting}
(5:9) ERROR: Una variable no puede ser de tipo «void».
        \end{lstlisting}
    \end{tcolorbox}

    
    \item \textbf{Caso 6:} Funcionamiento erróneo
    \begin{tcolorbox}[title={Código fuente}, colback=white, breakable]
        \begin{lstlisting}
/* Usar un identificador dos veces es error semántico, no sintáctico. */
var int a;

function int a(string arg) {
    output arg
    /* El sintáctico no verifica que se devuelva un valor valido. */
};

/* Podemos realizar varias acciones sobre identificadores. */

/* Asignar un valor, si es una variable. */
a = a + 3;

/* Realizar una llamada, si es función. */
result = a();

/* No realizar ninguna acción es inválido. */
a;
        \end{lstlisting}      
    \end{tcolorbox}

    \begin{tcolorbox}[title={Errores detectados}, colback=white]
        \begin{lstlisting}
(7:2) ERROR: Expresión incorrecta: Se esperaba alguna acción sobre el identificador.
        \end{lstlisting}
    \end{tcolorbox}

\end{enumerate}
